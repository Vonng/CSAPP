#include<stdio.h>
#include<stdint.h>

// gcc  arith.c -o arith && ./arith

/***********************************************************************
Exercise 2.27
*************************************************************************/
int uadd_ok(unsigned x, unsigned y){
    unsigned s = x + y;
    if (s < x || s <y){
        return 0;
    }
    return 1;
}

/***********************************************************************
Exercise 2.29
*************************************************************************/
int tadd_ok(int x,int y){
    int s = x + y;
    if ((x < 0 && y < 0 && s >= 0) || (x>0 && y>0 && s <= 0)){
        return 0;
    }
    return 1;
}


/***********************************************************************
Exercise 2.30
*************************************************************************/
int buggy_tadd_ok(int x, int y){
    int sum = x + y;
    return (sum-x == y) && (sum -y == x);
}

/***********************************************************************
Exercise 2.32
*************************************************************************/
/* Buggy */
// Corner case:  -TMin
int tsub_ok(int x, int y){
    return tadd_ok(x,-y);
}


/***********************************************************************
Exercise 2.35
*************************************************************************/
int tmult_ok(int x, int y){
  int p = x * y;
  /* Either x is zero, or dividing p by x gives y */
  return !x || p / x == y;
}


/***********************************************************************
Exercise 2.36
*************************************************************************/
int tmult_ok2(int x, int y){
  int64_t p =  (int64_t) (x * y);
  return (p & ~ (int64_t)(0xFFFFFFFF));
}

/* Official answer */
int tmult_ok3(int x, int y){
  int64_t p =  (int64_t) (x * y);
  return p == (int)p;
}


/***********************************************************************
Exercise 2.36
*************************************************************************/
void section_2_3_7(){
    printf("11 = 4 *%d + (%d)\n", 11 / 4, 11 % 4);
    printf("-11 = 4 *%d + (%d)\n", -11 / 4, -11 % 4);
    printf("11 = -4 *%d + (%d)\n", 11 / -4, 11 % -4);
    printf("-11 = -4 *%d + (%d)\n", -11 / -4, -11 % -4);
    printf("%d" , -11 >> 2);
}


/***********************************************************************
Exercise 2.42
*************************************************************************/
int32_t div16(int32_t x){
    int bias = (x >> 31) & 0xF;
    return (x + bias) >> 4;
}

/***********************************************************************
Exercise 2.43
*************************************************************************/
int arith(int x , int y){
    int result = 0;
//    result = x * M + y / N;
    return result;
}


int optarith(int x , int y){
    int t = x;
    x <<= 5;  // 32 * x
    x -= t;   // 31 * x
    if (y < 0 ) y += 7; // y + 2^3-1
    y >>= 3; //y / 8
    return x + y;
}




int main(){
    section_2_3_7();
}